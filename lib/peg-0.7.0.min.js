/*
 * PEG.js 0.7.0
 *
 * http://pegjs.majda.cz/
 *
 * Copyright (c) 2010-2012 David Majda
 * Licensed under the MIT license
 */var PEG=function(undefined){var modules={define:function(e,t){function i(e){var t=n+e,r=/[^\/]+\/\.\.\/|\.\//;while(r.test(t))t=t.replace(r,"");return modules[t]}var n=e.replace(/(^|\/)[^/]+$/,"$1"),r={exports:{}};t(r,i),this[e]=r.exports}};return modules.define("utils",function(e,t){var n={range:function(e,t){t===undefined&&(t=e,e=0);var n=new Array(Math.max(0,t-e));for(var r=0,i=e;i<t;r++,i++)n[r]=i;return n},find:function(e,t){var n=e.length;for(var r=0;r<n;r++)if(t(e[r]))return e[r]},contains:function(e,t){var n=e.length;for(var r=0;r<n;r++)if(e[r]===t)return!0;return!1},each:function(e,t){var n=e.length;for(var r=0;r<n;r++)t(e[r],r)},map:function(e,t){var n=[],r=e.length;for(var i=0;i<r;i++)n[i]=t(e[i],i);return n},pluck:function(e,t){return n.map(e,function(e){return e[t]})},keys:function(e){var t=[];for(var n in e)t.push(n);return t},values:function(e){var t=[];for(var n in e)t.push(e[n]);return t},clone:function(e){var t={};for(var n in e)t[n]=e[n];return t},defaults:function(e,t){for(var n in t)e[n]===undefined&&(e[n]=t[n])},subclass:function(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n},padLeft:function(e,t,n){var r=e,i=n-e.length;for(var s=0;s<i;s++)r=t+r;return r},escape:function(e){var t=e.charCodeAt(0),r,i;return t<=255?(r="x",i=2):(r="u",i=4),"\\"+r+n.padLeft(t.toString(16).toUpperCase(),"0",i)},quote:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,n.escape)+'"'},quoteForRegexpClass:function(e){return e.replace(/\\/g,"\\\\").replace(/\//g,"\\/").replace(/\]/g,"\\]").replace(/\^/g,"\\^").replace(/-/g,"\\-").replace(/\0/g,"\\0").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\v/g,"\\x0B").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x01-\x08\x0E-\x1F\x80-\uFFFF]/g,n.escape)},buildNodeVisitor:function(e){return function(t){return e[t.type].apply(null,arguments)}},findRuleByName:function(e,t){return n.find(e.rules,function(e){return e.name===t})}};e.exports=n}),modules.define("grammar-error",function(e,t){var n=t("./utils");e.exports=function(e){this.name="GrammarError",this.message=e},n.subclass(e.exports,Error)}),modules.define("parser",function(e,t){e.exports=function(){function e(e,t){function n(){this.constructor=e}n.prototype=t.prototype,e.prototype=new n}function n(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E-\x1F\x80-\uFFFF]/g,escape)+'"'}var r={parse:function(e){function p(e,t,n){var r=e,i=n-e.length;for(var s=0;s<i;s++)r=t+r;return r}function d(e){var t=e.charCodeAt(0),n,r;return t<=255?(n="x",r=2):(n="u",r=4),"\\"+n+p(t.toString(16).toUpperCase(),"0",r)}function v(){function t(){var t;for(;a<u;a++)t=e.charAt(a),t==="\n"?(f.seenCR||f.line++,f.column=1,f.seenCR=!1):t==="\r"||t==="\u2028"||t==="\u2029"?(f.line++,f.column=1,f.seenCR=!0):(f.column++,f.seenCR=!1)}return a!==u&&(a>u&&(a=0,f={line:1,column:1,seenCR:!1}),t()),f}function m(){return u}function g(){return v().line}function y(){return v().column}function b(e){if(o<c)return;o>c&&(c=o,h=[]),h.push(e)}function w(){var e,t,n,r,i,s,a;t=o,n=o,r=mt();if(r!==null){i=E(),i=i!==null?i:"";if(i!==null){a=S();if(a!==null){s=[];while(a!==null)s.push(a),a=S()}else s=null;s!==null?e=[r,i,s]:(e=null,o=n)}else e=null,o=n}else e=null,o=n;return e!==null&&(u=t,e=function(e,t){return{type:"grammar",initializer:e!==""?e:null,rules:t,startRule:t[0].name}}(i,s)),e===null&&(o=t),e}function E(){var e,t,n,r,i;return t=o,n=o,r=A(),r!==null?(i=H(),i=i!==null?i:"",i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"initializer",code:e}}(r)),e===null&&(o=t),e}function S(){var e,t,n,r,i,s,a,f;return t=o,n=o,r=V(),r!==null?(i=J(),i=i!==null?i:"",i!==null?(s=D(),s!==null?(a=x(),a!==null?(f=H(),f=f!==null?f:"",f!==null?e=[r,i,s,a,f]:(e=null,o=n)):(e=null,o=n)):(e=null,o=n)):(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e,t,n){return{type:"rule",name:e,expression:t!==""?{type:"named",name:t,expression:n}:n}}(r,i,a)),e===null&&(o=t),e}function x(){var e,t,n,r,i,s,a,f,l;t=o,n=o,r=T();if(r!==null){i=[],a=o,f=B(),f!==null?(l=T(),l!==null?s=[f,l]:(s=null,o=a)):(s=null,o=a);while(s!==null)i.push(s),a=o,f=B(),f!==null?(l=T(),l!==null?s=[f,l]:(s=null,o=a)):(s=null,o=a);i!==null?e=[r,i]:(e=null,o=n)}else e=null,o=n;return e!==null&&(u=t,e=function(e,t){if(t.length>0){var n=[e].concat(Tt.map(t,function(e){return e[1]}));return{type:"choice",alternatives:n}}return e}(r,i)),e===null&&(o=t),e}function T(){var e,t,n,r,i;t=o,n=o,r=[],i=N();while(i!==null)r.push(i),i=N();r!==null?(i=A(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e,t){var n=e.length!==1?{type:"sequence",elements:e}:e[0];return{type:"action",expression:n,code:t}}(r,i)),e===null&&(o=t);if(e===null){t=o,e=[],n=N();while(n!==null)e.push(n),n=N();e!==null&&(u=t,e=function(e){return e.length!==1?{type:"sequence",elements:e}:e[0]}(e)),e===null&&(o=t)}return e}function N(){var e,t,n,r,i,s;return t=o,n=o,r=V(),r!==null?(i=P(),i!==null?(s=C(),s!==null?e=[r,i,s]:(e=null,o=n)):(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e,t){return{type:"labeled",label:e,expression:t}}(r,s)),e===null&&(o=t),e===null&&(e=C()),e}function C(){var e,t,n,r,i;return t=o,n=o,r=I(),r!==null?(i=k(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"text",expression:e}}(i)),e===null&&(o=t),e===null&&(t=o,n=o,r=j(),r!==null?(i=A(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"semantic_and",code:e}}(i)),e===null&&(o=t),e===null&&(t=o,n=o,r=j(),r!==null?(i=k(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"simple_and",expression:e}}(i)),e===null&&(o=t),e===null&&(t=o,n=o,r=F(),r!==null?(i=A(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"semantic_not",code:e}}(i)),e===null&&(o=t),e===null&&(t=o,n=o,r=F(),r!==null?(i=k(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"simple_not",expression:e}}(i)),e===null&&(o=t),e===null&&(e=k()))))),e}function k(){var e,t,n,r,i;return t=o,n=o,r=L(),r!==null?(i=q(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"optional",expression:e}}(r)),e===null&&(o=t),e===null&&(t=o,n=o,r=L(),r!==null?(i=R(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"zero_or_more",expression:e}}(r)),e===null&&(o=t),e===null&&(t=o,n=o,r=L(),r!==null?(i=U(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"one_or_more",expression:e}}(r)),e===null&&(o=t),e===null&&(e=L()))),e}function L(){var e,t,n,r,i,s,a,f,c;return t=o,n=o,r=V(),r!==null?(s=o,l++,a=o,f=J(),f=f!==null?f:"",f!==null?(c=D(),c!==null?i=[f,c]:(i=null,o=a)):(i=null,o=a),l--,i===null?i="":(i=null,o=s),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return{type:"rule_ref",name:e}}(r)),e===null&&(o=t),e===null&&(e=$(),e===null&&(e=tt(),e===null&&(t=o,e=X(),e!==null&&(u=t,e=function(){return{type:"any"}}()),e===null&&(o=t),e===null&&(t=o,n=o,r=z(),r!==null?(i=x(),i!==null?(s=W(),s!==null?e=[r,i,s]:(e=null,o=n)):(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return e}(i)),e===null&&(o=t))))),e}function A(){var e,t,n,r,i;return l++,t=o,n=o,r=O(),r!==null?(i=mt(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return e.substr(1,e.length-2)}(r)),e===null&&(o=t),l--,l===0&&e===null&&b("action"),e}function O(){var t,n,r,i,s,u;n=o,r=o,e.charCodeAt(o)===123?(i="{",o++):(i=null,l===0&&b('"{"'));if(i!==null){s=[],u=O(),u===null&&(u=M());while(u!==null)s.push(u),u=O(),u===null&&(u=M());s!==null?(e.charCodeAt(o)===125?(u="}",o++):(u=null,l===0&&b('"}"')),u!==null?t=[i,s,u]:(t=null,o=r)):(t=null,o=r)}else t=null,o=r;return t!==null&&(t=e.substring(o,n)),t}function M(){var e,t;t=_();if(t!==null){e=[];while(t!==null)e.push(t),t=_()}else e=null;return e}function _(){var t;return/^[^{}]/.test(e.charAt(o))?(t=e.charAt(o),o++):(t=null,l===0&&b("[^{}]")),t}function D(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===61?(i="=",o++):(i=null,l===0&&b('"="')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"="}()),t===null&&(o=n),t}function P(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===58?(i=":",o++):(i=null,l===0&&b('":"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return":"}()),t===null&&(o=n),t}function H(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===59?(i=";",o++):(i=null,l===0&&b('";"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return";"}()),t===null&&(o=n),t}function B(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===47?(i="/",o++):(i=null,l===0&&b('"/"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"/"}()),t===null&&(o=n),t}function j(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===38?(i="&",o++):(i=null,l===0&&b('"&"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"&"}()),t===null&&(o=n),t}function F(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===33?(i="!",o++):(i=null,l===0&&b('"!"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"!"}()),t===null&&(o=n),t}function I(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===36?(i="$",o++):(i=null,l===0&&b('"$"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"$"}()),t===null&&(o=n),t}function q(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===63?(i="?",o++):(i=null,l===0&&b('"?"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"?"}()),t===null&&(o=n),t}function R(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===42?(i="*",o++):(i=null,l===0&&b('"*"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"*"}()),t===null&&(o=n),t}function U(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===43?(i="+",o++):(i=null,l===0&&b('"+"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"+"}()),t===null&&(o=n),t}function z(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===40?(i="(",o++):(i=null,l===0&&b('"("')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"("}()),t===null&&(o=n),t}function W(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===41?(i=")",o++):(i=null,l===0&&b('")"')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return")"}()),t===null&&(o=n),t}function X(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===46?(i=".",o++):(i=null,l===0&&b('"."')),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"."}()),t===null&&(o=n),t}function V(){var t,n,r,i,s,a,f,c,h;l++,n=o,r=o,s=o,a=o,f=pt(),f===null&&(e.charCodeAt(o)===95?(f="_",o++):(f=null,l===0&&b('"_"')));if(f!==null){c=[],h=pt(),h===null&&(h=ct(),h===null&&(e.charCodeAt(o)===95?(h="_",o++):(h=null,l===0&&b('"_"'))));while(h!==null)c.push(h),h=pt(),h===null&&(h=ct(),h===null&&(e.charCodeAt(o)===95?(h="_",o++):(h=null,l===0&&b('"_"'))));c!==null?i=[f,c]:(i=null,o=a)}else i=null,o=a;return i!==null&&(i=e.substring(o,s)),i!==null?(s=mt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e){return e}(i)),t===null&&(o=n),l--,l===0&&t===null&&b("identifier"),t}function $(){var t,n,r,i,s,a;return l++,n=o,r=o,i=K(),i===null&&(i=Y()),i!==null?(e.charCodeAt(o)===105?(s="i",o++):(s=null,l===0&&b('"i"')),s=s!==null?s:"",s!==null?(a=mt(),a!==null?t=[i,s,a]:(t=null,o=r)):(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e,t){return{type:"literal",value:e,ignoreCase:t==="i"}}(i,s)),t===null&&(o=n),l--,l===0&&t===null&&b("literal"),t}function J(){var e,t,n,r,i;return l++,t=o,n=o,r=K(),r===null&&(r=Y()),r!==null?(i=mt(),i!==null?e=[r,i]:(e=null,o=n)):(e=null,o=n),e!==null&&(u=t,e=function(e){return e}(r)),e===null&&(o=t),l--,l===0&&e===null&&b("string"),e}function K(){var t,n,r,i,s,a;n=o,r=o,e.charCodeAt(o)===34?(i='"',o++):(i=null,l===0&&b('"\\""'));if(i!==null){s=[],a=Q();while(a!==null)s.push(a),a=Q();s!==null?(e.charCodeAt(o)===34?(a='"',o++):(a=null,l===0&&b('"\\""')),a!==null?t=[i,s,a]:(t=null,o=r)):(t=null,o=r)}else t=null,o=r;return t!==null&&(u=n,t=function(e){return e.join("")}(s)),t===null&&(o=n),t}function Q(){var e;return e=G(),e===null&&(e=ot(),e===null&&(e=ut(),e===null&&(e=at(),e===null&&(e=ft(),e===null&&(e=lt()))))),e}function G(){var t,n,r,i,s;return n=o,r=o,s=o,l++,e.charCodeAt(o)===34?(i='"',o++):(i=null,l===0&&b('"\\""')),i===null&&(e.charCodeAt(o)===92?(i="\\",o++):(i=null,l===0&&b('"\\\\"')),i===null&&(i=Et())),l--,i===null?i="":(i=null,o=s),i!==null?(e.length>o?(s=e.charAt(o),o++):(s=null,l===0&&b("any character")),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e){return e}(s)),t===null&&(o=n),t}function Y(){var t,n,r,i,s,a;n=o,r=o,e.charCodeAt(o)===39?(i="'",o++):(i=null,l===0&&b('"\'"'));if(i!==null){s=[],a=Z();while(a!==null)s.push(a),a=Z();s!==null?(e.charCodeAt(o)===39?(a="'",o++):(a=null,l===0&&b('"\'"')),a!==null?t=[i,s,a]:(t=null,o=r)):(t=null,o=r)}else t=null,o=r;return t!==null&&(u=n,t=function(e){return e.join("")}(s)),t===null&&(o=n),t}function Z(){var e;return e=et(),e===null&&(e=ot(),e===null&&(e=ut(),e===null&&(e=at(),e===null&&(e=ft(),e===null&&(e=lt()))))),e}function et(){var t,n,r,i,s;return n=o,r=o,s=o,l++,e.charCodeAt(o)===39?(i="'",o++):(i=null,l===0&&b('"\'"')),i===null&&(e.charCodeAt(o)===92?(i="\\",o++):(i=null,l===0&&b('"\\\\"')),i===null&&(i=Et())),l--,i===null?i="":(i=null,o=s),i!==null?(e.length>o?(s=e.charAt(o),o++):(s=null,l===0&&b("any character")),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e){return e}(s)),t===null&&(o=n),t}function tt(){var t,n,r,i,s,a,f,c,h;l++,n=o,r=o,e.charCodeAt(o)===91?(i="[",o++):(i=null,l===0&&b('"["'));if(i!==null){e.charCodeAt(o)===94?(s="^",o++):(s=null,l===0&&b('"^"')),s=s!==null?s:"";if(s!==null){a=[],f=nt(),f===null&&(f=rt());while(f!==null)a.push(f),f=nt(),f===null&&(f=rt());a!==null?(e.charCodeAt(o)===93?(f="]",o++):(f=null,l===0&&b('"]"')),f!==null?(e.charCodeAt(o)===105?(c="i",o++):(c=null,l===0&&b('"i"')),c=c!==null?c:"",c!==null?(h=mt(),h!==null?t=[i,s,a,f,c,h]:(t=null,o=r)):(t=null,o=r)):(t=null,o=r)):(t=null,o=r)}else t=null,o=r}else t=null,o=r;return t!==null&&(u=n,t=function(e,t,n){var r=Tt.map(t,function(e){return e.data}),i="["+e+Tt.map(t,function(e){return e.rawText}).join("")+"]"+n;return{type:"class",parts:r,rawText:i,inverted:e==="^",ignoreCase:n==="i"}}(s,a,c)),t===null&&(o=n),l--,l===0&&t===null&&b("character class"),t}function nt(){var t,n,r,i,s,a;return n=o,r=o,i=rt(),i!==null?(e.charCodeAt(o)===45?(s="-",o++):(s=null,l===0&&b('"-"')),s!==null?(a=rt(),a!==null?t=[i,s,a]:(t=null,o=r)):(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e,t){if(e.data.charCodeAt(0)>t.data.charCodeAt(0))throw new this.SyntaxError("Invalid character range: "+e.rawText+"-"+t.rawText+".");return{data:[e.data,t.data],rawText:e.rawText+"-"+t.rawText}}(i,a)),t===null&&(o=n),t}function rt(){var e,t;return t=o,e=it(),e!==null&&(u=t,e=function(e){return{data:e,rawText:Tt.quoteForRegexpClass(e)}}(e)),e===null&&(o=t),e}function it(){var e;return e=st(),e===null&&(e=ot(),e===null&&(e=ut(),e===null&&(e=at(),e===null&&(e=ft(),e===null&&(e=lt()))))),e}function st(){var t,n,r,i,s;return n=o,r=o,s=o,l++,e.charCodeAt(o)===93?(i="]",o++):(i=null,l===0&&b('"]"')),i===null&&(e.charCodeAt(o)===92?(i="\\",o++):(i=null,l===0&&b('"\\\\"')),i===null&&(i=Et())),l--,i===null?i="":(i=null,o=s),i!==null?(e.length>o?(s=e.charAt(o),o++):(s=null,l===0&&b("any character")),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e){return e}(s)),t===null&&(o=n),t}function ot(){var t,n,r,i,s,a;return n=o,r=o,e.charCodeAt(o)===92?(i="\\",o++):(i=null,l===0&&b('"\\\\"')),i!==null?(a=o,l++,s=ct(),s===null&&(e.charCodeAt(o)===120?(s="x",o++):(s=null,l===0&&b('"x"')),s===null&&(e.charCodeAt(o)===117?(s="u",o++):(s=null,l===0&&b('"u"')),s===null&&(s=Et()))),l--,s===null?s="":(s=null,o=a),s!==null?(e.length>o?(a=e.charAt(o),o++):(a=null,l===0&&b("any character")),a!==null?t=[i,s,a]:(t=null,o=r)):(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e){return e.replace("b","\b").replace("f","\f").replace("n","\n").replace("r","\r").replace("t","	").replace("v","")}(a)),t===null&&(o=n),t}function ut(){var t,n,r,i,s,a;return n=o,r=o,e.substr(o,2)==="\\0"?(i="\\0",o+=2):(i=null,l===0&&b('"\\\\0"')),i!==null?(a=o,l++,s=ct(),l--,s===null?s="":(s=null,o=a),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(){return"\0"}()),t===null&&(o=n),t}function at(){var t,n,r,i,s,a,f,c,h;return n=o,r=o,e.substr(o,2)==="\\x"?(i="\\x",o+=2):(i=null,l===0&&b('"\\\\x"')),i!==null?(a=o,f=o,c=ht(),c!==null?(h=ht(),h!==null?s=[c,h]:(s=null,o=f)):(s=null,o=f),s!==null&&(s=e.substring(o,a)),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e){return String.fromCharCode(parseInt(e,16))}(s)),t===null&&(o=n),t}function ft(){var t,n,r,i,s,a,f,c,h,p,d;return n=o,r=o,e.substr(o,2)==="\\u"?(i="\\u",o+=2):(i=null,l===0&&b('"\\\\u"')),i!==null?(a=o,f=o,c=ht(),c!==null?(h=ht(),h!==null?(p=ht(),p!==null?(d=ht(),d!==null?s=[c,h,p,d]:(s=null,o=f)):(s=null,o=f)):(s=null,o=f)):(s=null,o=f),s!==null&&(s=e.substring(o,a)),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e){return String.fromCharCode(parseInt(e,16))}(s)),t===null&&(o=n),t}function lt(){var t,n,r,i,s;return n=o,r=o,e.charCodeAt(o)===92?(i="\\",o++):(i=null,l===0&&b('"\\\\"')),i!==null?(s=wt(),s!==null?t=[i,s]:(t=null,o=r)):(t=null,o=r),t!==null&&(u=n,t=function(e){return e}(s)),t===null&&(o=n),t}function ct(){var t;return/^[0-9]/.test(e.charAt(o))?(t=e.charAt(o),o++):(t=null,l===0&&b("[0-9]")),t}function ht(){var t;return/^[0-9a-fA-F]/.test(e.charAt(o))?(t=e.charAt(o),o++):(t=null,l===0&&b("[0-9a-fA-F]")),t}function pt(){var e;return e=dt(),e===null&&(e=vt()),e}function dt(){var t;return/^[a-z]/.test(e.charAt(o))?(t=e.charAt(o),o++):(t=null,l===0&&b("[a-z]")),t}function vt(){var t;return/^[A-Z]/.test(e.charAt(o))?(t=e.charAt(o),o++):(t=null,l===0&&b("[A-Z]")),t}function mt(){var e,t;e=[],t=St(),t===null&&(t=wt(),t===null&&(t=gt()));while(t!==null)e.push(t),t=St(),t===null&&(t=wt(),t===null&&(t=gt()));return e}function gt(){var e;return l++,e=yt(),e===null&&(e=bt()),l--,l===0&&e===null&&b("comment"),e}function yt(){var t,n,r,i,s,u,a,f;n=o,e.substr(o,2)==="//"?(r="//",o+=2):(r=null,l===0&&b('"//"'));if(r!==null){i=[],u=o,f=o,l++,a=Et(),l--,a===null?a="":(a=null,o=f),a!==null?(e.length>o?(f=e.charAt(o),o++):(f=null,l===0&&b("any character")),f!==null?s=[a,f]:(s=null,o=u)):(s=null,o=u);while(s!==null)i.push(s),u=o,f=o,l++,a=Et(),l--,a===null?a="":(a=null,o=f),a!==null?(e.length>o?(f=e.charAt(o),o++):(f=null,l===0&&b("any character")),f!==null?s=[a,f]:(s=null,o=u)):(s=null,o=u);i!==null?t=[r,i]:(t=null,o=n)}else t=null,o=n;return t}function bt(){var t,n,r,i,s,u,a,f;n=o,e.substr(o,2)==="/*"?(r="/*",o+=2):(r=null,l===0&&b('"/*"'));if(r!==null){i=[],u=o,f=o,l++,e.substr(o,2)==="*/"?(a="*/",o+=2):(a=null,l===0&&b('"*/"')),l--,a===null?a="":(a=null,o=f),a!==null?(e.length>o?(f=e.charAt(o),o++):(f=null,l===0&&b("any character")),f!==null?s=[a,f]:(s=null,o=u)):(s=null,o=u);while(s!==null)i.push(s),u=o,f=o,l++,e.substr(o,2)==="*/"?(a="*/",o+=2):(a=null,l===0&&b('"*/"')),l--,a===null?a="":(a=null,o=f),a!==null?(e.length>o?(f=e.charAt(o),o++):(f=null,l===0&&b("any character")),f!==null?s=[a,f]:(s=null,o=u)):(s=null,o=u);i!==null?(e.substr(o,2)==="*/"?(s="*/",o+=2):(s=null,l===0&&b('"*/"')),s!==null?t=[r,i,s]:(t=null,o=n)):(t=null,o=n)}else t=null,o=n;return t}function wt(){var t;return l++,e.charCodeAt(o)===10?(t="\n",o++):(t=null,l===0&&b('"\\n"')),t===null&&(e.substr(o,2)==="\r\n"?(t="\r\n",o+=2):(t=null,l===0&&b('"\\r\\n"')),t===null&&(e.charCodeAt(o)===13?(t="\r",o++):(t=null,l===0&&b('"\\r"')),t===null&&(e.charCodeAt(o)===8232?(t="\u2028",o++):(t=null,l===0&&b('"\\u2028"')),t===null&&(e.charCodeAt(o)===8233?(t="\u2029",o++):(t=null,l===0&&b('"\\u2029"')))))),l--,l===0&&t===null&&b("end of line"),t}function Et(){var t;return/^[\n\r\u2028\u2029]/.test(e.charAt(o))?(t=e.charAt(o),o++):(t=null,l===0&&b("[\\n\\r\\u2028\\u2029]")),t}function St(){var t;return l++,/^[ \t\x0B\f\xA0\uFEFF\u1680\u180E\u2000-\u200A\u202F\u205F\u3000]/.test(e.charAt(o))?(t=e.charAt(o),o++):(t=null,l===0&&b("[ \\t\\x0B\\f\\xA0\\uFEFF\\u1680\\u180E\\u2000-\\u200A\\u202F\\u205F\\u3000]")),l--,l===0&&t===null&&b("whitespace"),t}function xt(e){e.sort();var t=null,n=[];for(var r=0;r<e.length;r++)e[r]!==t&&(n.push(e[r]),t=e[r]);return n}var r={grammar:w},i=arguments.length>1?arguments[1]:{},s;if(i.startRule!==undefined){s=i.startRule;if(r[s]===undefined)throw new Error("Can't start parsing from rule "+n(s)+".")}else s="grammar";var o=0,u=0,a=0,f={line:1,column:1,seenCR:!1},l=0,c=0,h=[],Tt=t("./utils"),Nt=r[s]();if(Nt===null||o!==e.length){u=Math.max(o,c);var Ct=u<e.length?e.charAt(u):null,kt=v();throw new this.SyntaxError(xt(h),Ct,u,kt.line,kt.column)}return Nt}};return r.SyntaxError=function(e,t,r,i,s){function o(e,t){var r,i;switch(e.length){case 0:r="end of input";break;case 1:r=e[0];break;default:r=e.slice(0,e.length-1).join(", ")+" or "+e[e.length-1]}return i=t?n(t):"end of input","Expected "+r+" but "+i+" found."}this.name="SyntaxError",this.expected=e,this.found=t,this.message=o(e,t),this.offset=r,this.line=i,this.column=s},e(r.SyntaxError,Error),r}()}),modules.define("compiler/passes/allocate-registers",function(e,t){var n=t("../../utils");e.exports=function(e){function i(e,n){e.posIndex=t.alloc(),n(),t.release(e.posIndex)}function s(e,t){t.resultIndex=e.resultIndex}function o(e,n){e.resultIndex=t.alloc(),n(),t.release(e.resultIndex)}function u(e){r.beginScope(),e(),r.endScope()}function a(){}function f(e){u(function(){d(e.expression)})}function l(e){s(e,e.expression),f(e)}function c(e){o(e.expression,function(){f(e)})}function h(e){i(e,function(){l(e)})}function p(e){e.params=r.buildParams()}var t=function(){var e=[];return{alloc:function(){var t;for(t=0;t<e.length;t++)if(e[t]===0)return e[t]=1,t;return e.push(1),e.length-1},use:function(t){e[t]++},release:function(t){e[t]--},maxIndex:function(){return e.length-1},reset:function(){e=[]}}}(),r=function(e){var t=[];return{beginScope:function(){t.push({})},endScope:function(){var n=t.pop(),r;for(r in n)e.release(n[r])},add:function(n,r){t[t.length-1][n]=r,e.use(r)},buildParams:function(){var e=t[t.length-1],n={},r;for(r in e)n[r]=e[r];return n}}}(t),d=n.buildNodeVisitor({grammar:function(e){n.each(e.rules,d)},rule:function(e){t.reset(),c(e),e.registerCount=t.maxIndex()+1},named:function(e){s(e,e.expression),d(e.expression)},choice:function(e){n.each(e.alternatives,function(t){s(e,t),u(function(){d(t)})})},action:function(e){i(e,function(){s(e,e.expression),u(function(){d(e.expression),p(e)})})},sequence:function(e){i(e,function(){n.each(e.elements,function(e){e.resultIndex=t.alloc(),d(e)}),n.each(e.elements,function(e){t.release(e.resultIndex)})})},labeled:function(e){r.add(e.label,e.resultIndex),l(e)},text:h,simple_and:h,simple_not:h,semantic_and:p,semantic_not:p,optional:l,zero_or_more:c,one_or_more:c,rule_ref:a,literal:a,"class":a,any:a});d(e)}}),modules.define("compiler/passes/generate-code",function(e,t){var n=t("../../utils");e.exports=function(e,t){function s(e,r){return r.string=n.quote,r.range=n.range,r.map=n.map,r.pluck=n.pluck,r.keys=n.keys,r.values=n.values,r.emit=u,r.options=t,r.r=function(e){return"r"+e},i[e](r)}function o(e){return function(t){return s(e,{node:t})}}t=n.clone(t),n.defaults(t,{cache:!1,allowedStartRules:[e.startRule]});var r=function(e){function t(e){function t(e){return e.charCodeAt(0).toString(16).toUpperCase()}return e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(e){return"\\x0"+t(e)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(e){return"\\x"+t(e)}).replace(/[\u0180-\u0FFF]/g,function(e){return"\\u0"+t(e)}).replace(/[\u1080-\uFFFF]/g,function(e){return"\\u"+t(e)})}function n(e){return"__p.push("+e+");"}function r(e,r,i){function s(e,t,n){return e.replace(new RegExp("^.{"+t+"}","gm"),function(e,t){return t===0?n?"":e:""})}var o=t(s(e.substring(0,r),i.indentLevel(),i.atBOL));return o.length>0?n('"'+o+'"'):""}var i={VERSION:"1.1.0",indentStep:2,commands:{"if":{params:/^(.*)$/,compile:function(e,t,n){return["if("+n[0]+"){",[]]},stackOp:"push"},"else":{params:/^$/,compile:function(e){var t=e.commandStack,n=t[t.length-1]==="else",r=t[t.length-1]==="if";if(n)throw new Error("Multiple #elses.");if(!r)throw new Error("Using #else outside of #if.");return["}else{",[]]},stackOp:"replace"},"for":{params:/^([a-zA-Z_][a-zA-Z0-9_]*)[ \t]+in[ \t]+(.*)$/,init:function(e){e.forCurrLevel=0,e.forMaxLevel=0},compile:function(e,t,n){var r="__c"+e.forCurrLevel,i="__l"+e.forCurrLevel,s="__i"+e.forCurrLevel;return e.forCurrLevel++,e.forMaxLevel<e.forCurrLevel&&(e.forMaxLevel=e.forCurrLevel),[r+"="+n[1]+";"+i+"="+r+".length;"+"for("+s+"=0;"+s+"<"+i+";"+s+"++){"+n[0]+"="+r+"["+s+"];",[n[0],r,i,s]]},exit:function(e){e.forCurrLevel--},stackOp:"push"},end:{params:/^$/,compile:function(e){var t=e.commandStack,n;if(t.length===0)throw new Error("Too many #ends.");return n=i.commands[t[t.length-1]].exit,n&&n(e),["}",[]]},stackOp:"pop"},block:{params:/^(.*)$/,compile:function(e,r,i){var s="__x",o="__n",u="__l",a="__i";return[s+'="'+t(r.substring(e.indentLevel()))+'";'+o+"=("+i[0]+').toString().split("\\n");'+u+"="+o+".length;"+"for("+a+"=0;"+a+"<"+u+";"+a+"++){"+o+"["+a+"]="+s+"+"+o+"["+a+']+"\\n";'+"}"+n(o+'.join("")'),[s,o,u,a]]},stackOp:"nop"}},template:function(t){function o(e,t){return e.atBOL=!1,[n(t),[]]}function u(e,t,n,r){var o,u,a;o=i.commands[n];if(!o)throw new Error("Unknown command: #"+n+".");u=o.params.exec(r);if(u===null)throw new Error("Invalid params for command #"+n+": "+r+".");return a=o.compile(e,t,u.slice(1)),s[o.stackOp](e.commandStack,n),e.atBOL=!0,a}var s={push:function(e,t){e.push(t)},replace:function(e,t){e[e.length-1]=t},pop:function(e){e.pop()},nop:function(){}},a={commandStack:[],atBOL:!0,indentLevel:function(){return i.indentStep*this.commandStack.length}},f="",l=["__p=[]"],c,h,p,d;for(c in i.commands)i.commands[c].init&&i.commands[c].init(a);while((h=/^([ \t]*)#([a-zA-Z_][a-zA-Z0-9_]*)(?:[ \t]+([^ \t\n][^\n]*))?[ \t]*(?:\n|$)|#\{([^}]*)\}/m.exec(t))!==null)f+=r(t,h.index,a),p=h[2]!==e&&h[2]!==""?u(a,h[1],h[2],h[3]||""):o(a,h[4]),f+=p[0],l=l.concat(p[1]),t=t.substring(h.index+h[0].length);f+=r(t,t.length,a);if(a.commandStack.length>0)throw new Error("Missing #end.");l.sort();for(d=0;d<l.length;d++)l[d]===l[d-1]&&l.splice(d--,1);return new Function("__v",["__v=__v||{};","var "+l.join(",")+";","with(__v){",f,'return __p.join("").replace(/^\\n+|\\n+$/g,"");};'].join(""))}};return i}(),i=function(){var e,t={},n={grammar:["(function(){","  /*","   * Generated by PEG.js 0.7.0.","   *","   * http://pegjs.majda.cz/","   */","  ","  function subclass(child, parent) {","    function ctor() { this.constructor = child; }","    ctor.prototype = parent.prototype;","    child.prototype = new ctor();","  }","  ","  function quote(s) {","    /*","     * ECMA-262, 5th ed., 7.8.4: All characters may appear literally in a","     * string literal except for the closing quote character, backslash,","     * carriage return, line separator, paragraph separator, and line feed.","     * Any character may appear in the form of an escape sequence.","     *","     * For portability, we also escape escape all control and non-ASCII",'     * characters. Note that "\\0" and "\\v" escape sequences are not used',"     * because JSHint does not like the first and IE the second.","     */","     return '\"' + s","      .replace(/\\\\/g, '\\\\\\\\')  // backslash","      .replace(/\"/g, '\\\\\"')    // closing quote character","      .replace(/\\x08/g, '\\\\b') // backspace","      .replace(/\\t/g, '\\\\t')   // horizontal tab","      .replace(/\\n/g, '\\\\n')   // line feed","      .replace(/\\f/g, '\\\\f')   // form feed","      .replace(/\\r/g, '\\\\r')   // carriage return","      .replace(/[\\x00-\\x07\\x0B\\x0E-\\x1F\\x80-\\uFFFF]/g, escape)","      + '\"';","  }","  ","  var result = {","    /*","     * Parses the input with a generated parser. If the parsing is successful,","     * returns a value explicitly or implicitly specified by the grammar from","     * which the parser was generated (see |PEG.buildParser|). If the parsing is","     * unsuccessful, throws |PEG.parser.SyntaxError| describing the error.","     */","    parse: function(input) {","      var parseFunctions = {","        #for rule in options.allowedStartRules",'          #{string(rule) + ": parse_" + rule + (rule !== options.allowedStartRules[options.allowedStartRules.length - 1] ? "," : "")}',"        #end","      };","      ","      var options = arguments.length > 1 ? arguments[1] : {},","          startRule;","      ","      if (options.startRule !== undefined) {","        startRule = options.startRule;","        ","        if (parseFunctions[startRule] === undefined) {",'          throw new Error("Can\'t start parsing from rule " + quote(startRule) + ".");',"        }","      } else {","        startRule = #{string(options.allowedStartRules[0])};","      }","      ","      var pos = 0;","      var reportedPos = 0;","      var cachedReportedPos = 0;","      var cachedReportedPosDetails = { line: 1, column: 1, seenCR: false };","      var reportFailures = 0;","      var rightmostFailuresPos = 0;","      var rightmostFailuresExpected = [];","      #if options.cache","        var cache = {};","      #end","      ","      function padLeft(input, padding, length) {","        var result = input;","        ","        var padLength = length - input.length;","        for (var i = 0; i < padLength; i++) {","          result = padding + result;","        }","        ","        return result;","      }","      ","      function escape(ch) {","        var charCode = ch.charCodeAt(0);","        var escapeChar;","        var length;","        ","        if (charCode <= 0xFF) {","          escapeChar = 'x';","          length = 2;","        } else {","          escapeChar = 'u';","          length = 4;","        }","        ","        return '\\\\' + escapeChar + padLeft(charCode.toString(16).toUpperCase(), '0', length);","      }","      ","      function computeReportedPosDetails() {","        function advanceCachedReportedPos() {","          var ch;","          ","          for (; cachedReportedPos < reportedPos; cachedReportedPos++) {","            ch = input.charAt(cachedReportedPos);",'            if (ch === "\\n") {',"              if (!cachedReportedPosDetails.seenCR) { cachedReportedPosDetails.line++; }","              cachedReportedPosDetails.column = 1;","              cachedReportedPosDetails.seenCR = false;",'            } else if (ch === "\\r" || ch === "\\u2028" || ch === "\\u2029") {',"              cachedReportedPosDetails.line++;","              cachedReportedPosDetails.column = 1;","              cachedReportedPosDetails.seenCR = true;","            } else {","              cachedReportedPosDetails.column++;","              cachedReportedPosDetails.seenCR = false;","            }","          }","        }","        ","        if (cachedReportedPos !== reportedPos) {","          if (cachedReportedPos > reportedPos) {","            cachedReportedPos = 0;","            cachedReportedPosDetails = { line: 1, column: 1, seenCR: false };","          }","          advanceCachedReportedPos();","        }","        ","        return cachedReportedPosDetails;","      }","      ","      function text() {","        return input.substring(reportedPos, pos);","      }","      ","      function offset() {","        return reportedPos;","      }","      ","      function line() {","        return computeReportedPosDetails().line;","      }","      ","      function column() {","        return computeReportedPosDetails().column;","      }","      ","      function matchFailed(failure) {","        if (pos < rightmostFailuresPos) {"
,"          return;","        }","        ","        if (pos > rightmostFailuresPos) {","          rightmostFailuresPos = pos;","          rightmostFailuresExpected = [];","        }","        ","        rightmostFailuresExpected.push(failure);","      }","      ","      #for rule in node.rules","        #block emit(rule)","        ","      #end","      ","      function cleanupExpected(expected) {","        expected.sort();","        ","        var lastExpected = null;","        var cleanExpected = [];","        for (var i = 0; i < expected.length; i++) {","          if (expected[i] !== lastExpected) {","            cleanExpected.push(expected[i]);","            lastExpected = expected[i];","          }","        }","        return cleanExpected;","      }","      ","      #if node.initializer","        #block emit(node.initializer)","      #end","      ","      var result = parseFunctions[startRule]();","      ","      /*","       * The parser is now in one of the following three states:","       *","       * 1. The parser successfully parsed the whole input.","       *","       *    - |result !== null|","       *    - |pos === input.length|","       *    - |rightmostFailuresExpected| may or may not contain something","       *","       * 2. The parser successfully parsed only a part of the input.","       *","       *    - |result !== null|","       *    - |pos < input.length|","       *    - |rightmostFailuresExpected| may or may not contain something","       *","       * 3. The parser did not successfully parse any part of the input.","       *","       *   - |result === null|","       *   - |pos === 0|","       *   - |rightmostFailuresExpected| contains at least one failure","       *","       * All code following this comment (including called functions) must","       * handle these states.","       */","      if (result === null || pos !== input.length) {","        reportedPos = Math.max(pos, rightmostFailuresPos);","        var found = reportedPos < input.length ? input.charAt(reportedPos) : null;","        var reportedPosDetails = computeReportedPosDetails();","        ","        throw new this.SyntaxError(","          cleanupExpected(rightmostFailuresExpected),","          found,","          reportedPos,","          reportedPosDetails.line,","          reportedPosDetails.column","        );","      }","      ","      return result;","    }","  };","  ","  /* Thrown when a parser encounters a syntax error. */","  ","  result.SyntaxError = function(expected, found, offset, line, column) {","    function buildMessage(expected, found) {","      var expectedHumanized, foundHumanized;","      ","      switch (expected.length) {","        case 0:",'          expectedHumanized = "end of input";',"          break;","        case 1:","          expectedHumanized = expected[0];","          break;","        default:",'          expectedHumanized = expected.slice(0, expected.length - 1).join(", ")','            + " or "',"            + expected[expected.length - 1];","      }","      ",'      foundHumanized = found ? quote(found) : "end of input";',"      ",'      return "Expected " + expectedHumanized + " but " + foundHumanized + " found.";',"    }","    ",'    this.name = "SyntaxError";',"    this.expected = expected;","    this.found = found;","    this.message = buildMessage(expected, found);","    this.offset = offset;","    this.line = line;","    this.column = column;","  };","  ","  subclass(result.SyntaxError, Error);","  ","  return result;","})()"],rule:["function parse_#{node.name}() {","  #if options.cache",'    var cacheKey = "#{node.name}@" + pos;',"    var cachedResult = cache[cacheKey];","    if (cachedResult) {","      pos = cachedResult.nextPos;","      return cachedResult.result;","    }","    ","  #end","  #if node.registerCount > 0",'    var #{map(range(node.registerCount), r).join(", ")};',"  #end","  ","  #block emit(node.expression)","  #if options.cache","    ","    cache[cacheKey] = {","      nextPos: pos,","      result:  #{r(node.expression.resultIndex)}","    };","  #end","  return #{r(node.expression.resultIndex)};","}"],named:["reportFailures++;","#block emit(node.expression)","reportFailures--;","if (reportFailures === 0 && #{r(node.resultIndex)} === null) {","  matchFailed(#{string(node.name)});","}"],choice:["#block emit(alternative)","#block nextAlternativesCode"],"choice.next":["if (#{r(node.resultIndex)} === null) {","  #block code","}"],action:["#{r(node.posIndex)} = pos;","#block emit(node.expression)","if (#{r(node.resultIndex)} !== null) {","  reportedPos = #{r(node.posIndex)};",'  #{r(node.resultIndex)} = (function(#{keys(node.params).join(", ")}) {#{node.code}})(#{map(values(node.params), r).join(", ")});',"}","if (#{r(node.resultIndex)} === null) {","  pos = #{r(node.posIndex)};","}"],sequence:["#{r(node.posIndex)} = pos;","#block code"],"sequence.iteration":["#block emit(element)","if (#{r(element.resultIndex)} !== null) {","  #block code","} else {","  #{r(node.resultIndex)} = null;","  pos = #{r(node.posIndex)};","}"],"sequence.inner":['#{r(node.resultIndex)} = [#{map(pluck(node.elements, "resultIndex"), r).join(", ")}];'],text:["#{r(node.posIndex)} = pos;","#block emit(node.expression)","if (#{r(node.resultIndex)} !== null) {","  #{r(node.resultIndex)} = input.substring(pos, #{r(node.posIndex)});","}"],simple_and:["#{r(node.posIndex)} = pos;","reportFailures++;","#block emit(node.expression)","reportFailures--;","if (#{r(node.resultIndex)} !== null) {",'  #{r(node.resultIndex)} = "";',"  pos = #{r(node.posIndex)};","} else {","  #{r(node.resultIndex)} = null;","}"],simple_not:["#{r(node.posIndex)} = pos;","reportFailures++;","#block emit(node.expression)","reportFailures--;","if (#{r(node.resultIndex)} === null) {",'  #{r(node.resultIndex)} = "";',"} else {","  #{r(node.resultIndex)} = null;","  pos = #{r(node.posIndex)};","}"],semantic_and:["reportedPos = pos;",'#{r(node.resultIndex)} = (function(#{keys(node.params).join(", ")}) {#{node.code}})(#{map(values(node.params), r).join(", ")}) ? "" : null;'],semantic_not:["reportedPos = pos;",'#{r(node.resultIndex)} = (function(#{keys(node.params).join(", ")}) {#{node.code}})(#{map(values(node.params), r).join(", ")}) ? null : "";'],optional:["#block emit(node.expression)",'#{r(node.resultIndex)} = #{r(node.resultIndex)} !== null ? #{r(node.resultIndex)} : "";'],zero_or_more:["#{r(node.resultIndex)} = [];","#block emit(node.expression)","while (#{r(node.expression.resultIndex)} !== null) {","  #{r(node.resultIndex)}.push(#{r(node.expression.resultIndex)});","  #block emit(node.expression)","}"],one_or_more:["#block emit(node.expression)","if (#{r(node.expression.resultIndex)} !== null) {","  #{r(node.resultIndex)} = [];","  while (#{r(node.expression.resultIndex)} !== null) {","    #{r(node.resultIndex)}.push(#{r(node.expression.resultIndex)});","    #block emit(node.expression)","  }","} else {","  #{r(node.resultIndex)} = null;","}"],rule_ref:["#{r(node.resultIndex)} = parse_#{node.name}();"],literal:["#if node.value.length === 0",'  #{r(node.resultIndex)} = "";',"#else","  #if !node.ignoreCase","    #if node.value.length === 1","      if (input.charCodeAt(pos) === #{node.value.charCodeAt(0)}) {","    #else","      if (input.substr(pos, #{node.value.length}) === #{string(node.value)}) {","    #end","  #else","    if (input.substr(pos, #{node.value.length}).toLowerCase() === #{string(node.value.toLowerCase())}) {","  #end","    #if !node.ignoreCase","      #{r(node.resultIndex)} = #{string(node.value)};","    #else","      #{r(node.resultIndex)} = input.substr(pos, #{node.value.length});","    #end",'    #{node.value.length > 1 ? "pos += " + node.value.length : "pos++"};',"  } else {","    #{r(node.resultIndex)} = null;","    if (reportFailures === 0) {","      matchFailed(#{string(string(node.value))});","    }","  }","#end"],"class":["if (#{regexp}.test(input.charAt(pos))) {","  #{r(node.resultIndex)} = input.charAt(pos);","  pos++;","} else {","  #{r(node.resultIndex)} = null;","  if (reportFailures === 0) {","    matchFailed(#{string(node.rawText)});","  }","}"],any:["if (input.length > pos) {","  #{r(node.resultIndex)} = input.charAt(pos);","  pos++;","} else {","  #{r(node.resultIndex)} = null;","  if (reportFailures === 0) {",'    matchFailed("any character");',"  }","}"]};for(e in n)t[e]=r.template(n[e].join("\n"));return t}(),u=n.buildNodeVisitor({grammar:o("grammar"),initializer:function(e){return e.code},rule:o("rule"),named:o("named"),choice:function(e){var t,n;for(var r=e.alternatives.length-1;r>=0;r--)n=r!==e.alternatives.length-1?s("choice.next",{node:e,code:t}):"",t=s("choice",{alternative:e.alternatives[r],nextAlternativesCode:n});return t},action:o("action"),sequence:function(e){var t=s("sequence.inner",{node:e});for(var n=e.elements.length-1;n>=0;n--)t=s("sequence.iteration",{node:e,element:e.elements[n],code:t});return s("sequence",{node:e,code:t})},labeled:function(e){return u(e.expression)},text:o("text"),simple_and:o("simple_and"),simple_not:o("simple_not"),semantic_and:o("semantic_and"),semantic_not:o("semantic_not"),optional:o("optional"),zero_or_more:o("zero_or_more"),one_or_more:o("one_or_more"),rule_ref:o("rule_ref"),literal:o("literal"),"class":function(e){var t;return e.parts.length>0?t="/^["+(e.inverted?"^":"")+n.map(e.parts,function(e){return e instanceof Array?n.quoteForRegexpClass(e[0])+"-"+n.quoteForRegexpClass(e[1]):n.quoteForRegexpClass(e)}).join("")+"]/"+(e.ignoreCase?"i":""):t=e.inverted?"/^[\\S\\s]/":"/^(?!)/",s("class",{node:e,regexp:t})},any:o("any")});e.code=u(e)}}),modules.define("compiler/passes/remove-proxy-rules",function(e,t){var n=t("../../utils");e.exports=function(e){function t(e){return e.type==="rule"&&e.expression.type==="rule_ref"}function r(e,t,r){function i(){}function s(e,t,n){u(e.expression,t,n)}function o(e){return function(t,r,i){n.each(t[e],function(e){u(e,r,i)})}}var u=n.buildNodeVisitor({grammar:o("rules"),rule:s,named:s,choice:o("alternatives"),sequence:o("elements"),labeled:s,text:s,simple_and:s,simple_not:s,semantic_and:i,semantic_not:i,optional:s,zero_or_more:s,one_or_more:s,action:s,rule_ref:function(e,t,n){e.name===t&&(e.name=n)},literal:i,"class":i,any:i});u(e,t,r)}var i=[];n.each(e.rules,function(n,s){t(n)&&(r(e,n.name,n.expression.name),n.name===e.startRule&&(e.startRule=n.expression.name),i.push(s))}),i.reverse(),n.each(i,function(t){e.rules.splice(t,1)})}}),modules.define("compiler/passes/report-left-recursion",function(e,t){var n=t("../../utils");e.exports=function(e){function t(){}function r(e,t){s(e.expression,t)}function i(e){return function(t,r){n.each(t[e],function(e){s(e,r)})}}var s=n.buildNodeVisitor({grammar:i("rules"),rule:function(e,t){s(e.expression,t.concat(e.name))},named:r,choice:i("alternatives"),action:r,sequence:function(e,t){e.elements.length>0&&s(e.elements[0],t)},labeled:r,text:r,simple_and:r,simple_not:r,semantic_and:t,semantic_not:t,optional:r,zero_or_more:r,one_or_more:r,rule_ref:function(t,r){if(n.contains(r,t.name))throw new PEG.GrammarError('Left recursion detected for rule "'+t.name+'".');s(n.findRuleByName(e,t.name),r)},literal:t,"class":t,any:t});s(e,[])}}),modules.define("compiler/passes/report-missing-rules",function(e,t){var n=t("../../utils");e.exports=function(e){function t(){}function r(e){s(e.expression)}function i(e){return function(t){n.each(t[e],s)}}var s=n.buildNodeVisitor({grammar:i("rules"),rule:r,named:r,choice:i("alternatives"),action:r,sequence:i("elements"),labeled:r,text:r,simple_and:r,simple_not:r,semantic_and:t,semantic_not:t,optional:r,zero_or_more:r,one_or_more:r,rule_ref:function(t){if(!n.findRuleByName(e,t.name))throw new PEG.GrammarError('Referenced rule "'+t.name+'" does not exist.')},literal:t,"class":t,any:t});s(e)}}),modules.define("compiler/passes",function(e,t){e.exports={reportMissingRules:t("./passes/report-missing-rules"),reportLeftRecursion:t("./passes/report-left-recursion"),removeProxyRules:t("./passes/remove-proxy-rules"),allocateRegisters:t("./passes/allocate-registers"),generateCode:t("./passes/generate-code")}}),modules.define("compiler",function(module,require){var utils=require("./utils");module.exports={passes:require("./compiler/passes"),appliedPassNames:["reportMissingRules","reportLeftRecursion","removeProxyRules","allocateRegisters","generateCode"],compile:function(ast,options){options===undefined&&(options={});var that=this,output=options.output!==undefined?options.output:"parser";utils.each(this.appliedPassNames,function(e){that.passes[e](ast,options)});switch(output){case"parser":return eval(ast.code);case"source":return ast.code}}}}),modules.define("peg",function(e,t){e.exports={VERSION:"0.7.0",GrammarError:t("./grammar-error"),parser:t("./parser"),compiler:t("./compiler"),buildParser:function(e,t){return this.compiler.compile(this.parser.parse(e),t)}}}),modules.peg}();